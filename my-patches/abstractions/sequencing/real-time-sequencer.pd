#N canvas 66 32 1854 977 12;
#X text 11 9 VERSION 0;
#X msg 93 692 30 110;
#X text 215 740 Recording incoming MIDI;
#X obj 146 44 tgl 20 0 \$0-i-rec-queue \$0-rec-queue Rec-Queue 23 10 0 12 #ff0400 #000000 #000000 0 1;
#X text 960 17 Need to kepp textfile closed \, otherwise might experience lag/buginess, f 40;
#X obj 984 170 inlet;
#X obj 146 92 bng 20 250 50 0 \$0-i-clear \$0-clear-dummy Clear-Sequence 23 10 0 12 #fcfcfc #000000 #000000;
#X obj 981 276 s \$0-i-bar;
#X obj 1430 804 tgl 20 0 empty empty Launch-Queue 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X msg 1430 830 set \$1;
#X obj 1430 777 r \$0-i-launch;
#X obj 1430 853 s \$0-launch;
#X msg 1454 618 line 0 \, auto;
#X obj 775 168 ctlin 1, f 8;
#X text 774 149 value - knob#;
#X text 122 665 CC;
#X text 143 692 Note;
#X obj 199 688 r \$0-i-bar;
#X obj 146 68 tgl 20 0 \$0-i-launch \$0-launch Launch-Queue 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 199 713 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 1454 670 unpack f f;
#X text 1289 104 ** in general since I am not good at finger drumming \, velocity should be considered constant or discarded and hard-coded with possibility of modification using a CC \; For oneshot sequencer \; - duration of holding the note does not matter \; - velocity should be constant with a CC \; For note sequencer \; - duration is important for ADSR \; - aftertouch could be useful \;, f 74;
#X text 1290 16 ** timer/realtime do not work here since there is no toggle to stop them. Easy to do this with a counter with desired precision (10ms) with metro 10;
#X floatatom 1044 247 5 1 55 1 bar-count - - 0;
#X obj 1006 197 sel 1;
#X obj 1006 222 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 980 149 Note count from signature;
#X floatatom 775 191 5 0 0 0 - - - 0;
#X floatatom 828 191 5 0 0 0 - - - 0;
#X text 295 19 Realtime sequencer: One-shot, f 29;
#X msg 82 667 45 1;
#N canvas 923 68 670 854 recording-unit 0;
#X obj 426 109 tgl 20 0 empty empty GO 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 426 212 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 426 237 f;
#X floatatom 426 262 12 0 0 1 ms - - 0;
#X obj 426 134 sel 1 0, f 11;
#X msg 426 159 1;
#X msg 463 159 0;
#X obj 426 85 spigot;
#X obj 480 85 tgl 20 0 empty empty rec-queue 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 310 112 spigot;
#X text 491 187 Resolution:25ms;
#X obj 310 368 pack f f f;
#X obj 377 287 f;
#X msg 390 174 0, f 2;
#X floatatom 377 310 5 0 0 0 - - - 0;
#X obj 519 155 s \$0-rec-queue;
#X obj 480 58 r \$0-i-rec-queue;
#X msg 519 132 set \$1;
#X obj 310 23 inlet;
#X obj 426 22 inlet;
#X text 43 564 With Rec-Queue \; - wait for right inlet (a bang \, specifying beginning of first bar) \; - with bang recieved \, timer starts \; - each time midi info arrives \, this subpatch packs it with timing information showing time passed since begining of the first bar or previous midi in and outputs it \; - with the next first bar back recording and timer turn off \;, f 69;
#X obj 310 344 f;
#X obj 310 140 t b l b, f 10;
#X obj 393 53 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 324 52 10 127;
#X obj 321 309 unpack;
#X text 44 686 IO \; - left inlet (list of 2) \; ** Key ON/OFF \, velocity \; ** Knob \, Value \; - Right inlet(bang) \; ** 1'st bar start \; - outlet (list of 3) \; ** time-passed \, key/knob \, velocity/value \;, f 45;
#X obj 426 187 metro 10;
#X obj 456 237 + 10;
#X text 352 23 midiinfo;
#X text 469 22 bar(rec) start;
#X listbox 104 124 20 0 0 0 - - - 0;
#X msg 317 487 -1;
#X obj 317 460 bng 20 250 50 0 empty \$0-i-clear Clear-Sequence 23 10 0 12 #fcfcfc #000000 #000000;
#X obj 317 512 text delete \$0-sequence-note-trig;
#X obj 310 396 text insert \$0-sequence-note-trig 1e+09;
#X connect 0 0 4 0;
#X connect 0 0 9 1;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 0 28 0;
#X connect 3 0 12 1;
#X connect 4 0 5 0;
#X connect 4 1 6 0;
#X connect 5 0 27 0;
#X connect 6 0 2 1;
#X connect 6 0 8 0;
#X connect 6 0 27 0;
#X connect 7 0 0 0;
#X connect 8 0 7 1;
#X connect 8 0 17 0;
#X connect 9 0 22 0;
#X connect 11 0 31 0;
#X connect 11 0 35 0;
#X connect 12 0 14 0;
#X connect 13 0 2 1;
#X connect 14 0 21 1;
#X connect 16 0 8 0;
#X connect 17 0 15 0;
#X connect 18 0 9 0;
#X connect 19 0 7 0;
#X connect 21 0 11 0;
#X connect 22 0 21 0;
#X connect 22 1 25 0;
#X connect 22 2 13 0;
#X connect 22 2 12 0;
#X connect 23 0 7 0;
#X connect 24 0 9 0;
#X connect 25 0 11 1;
#X connect 25 1 11 2;
#X connect 27 0 1 0;
#X connect 28 0 2 1;
#X connect 32 0 34 0;
#X connect 33 0 32 0;
#X coords 0 -1 1 1 150 50 1 100 100;
#X restore 56 740 pd recording-unit;
#X obj 679 44 text define -k \$0-sequence-CC-velocity;
#A set;
#X obj 679 68 text define -k \$0-sequence-CC-1;
#A set;
#X obj 679 92 text define -k \$0-sequence-CC-2;
#A set;
#X obj 679 20 text define -k \$0-sequence-note-trig;
#A set;
#X obj 1454 645 text sequence \$0-sequence-note-trig -w 1;
#X obj 880 869 outlet;
#X msg 453 690 30 110;
#X text 575 738 Recording incoming MIDI;
#X text 482 663 CC;
#X text 503 690 Note;
#X obj 559 686 r \$0-i-bar;
#X obj 559 711 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 442 665 45 1;
#N canvas 923 68 670 854 recording-unit 0;
#X obj 426 109 tgl 20 0 empty empty GO 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 426 212 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 426 237 f;
#X floatatom 426 262 12 0 0 1 ms - - 0;
#X obj 426 134 sel 1 0, f 11;
#X msg 426 159 1;
#X msg 463 159 0;
#X obj 426 85 spigot;
#X obj 480 85 tgl 20 0 empty empty rec-queue 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 310 112 spigot;
#X text 491 187 Resolution:25ms;
#X obj 310 368 pack f f f;
#X obj 377 287 f;
#X msg 390 174 0, f 2;
#X floatatom 377 310 5 0 0 0 - - - 0;
#X obj 519 155 s \$0-rec-queue;
#X obj 480 58 r \$0-i-rec-queue;
#X msg 519 132 set \$1;
#X obj 310 23 inlet;
#X obj 426 22 inlet;
#X text 43 564 With Rec-Queue \; - wait for right inlet (a bang \, specifying beginning of first bar) \; - with bang recieved \, timer starts \; - each time midi info arrives \, this subpatch packs it with timing information showing time passed since begining of the first bar or previous midi in and outputs it \; - with the next first bar back recording and timer turn off \;, f 69;
#X obj 310 344 f;
#X obj 310 140 t b l b, f 10;
#X obj 393 53 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 324 52 10 127;
#X obj 321 309 unpack;
#X text 44 686 IO \; - left inlet (list of 2) \; ** Key ON/OFF \, velocity \; ** Knob \, Value \; - Right inlet(bang) \; ** 1'st bar start \; - outlet (list of 3) \; ** time-passed \, key/knob \, velocity/value \;, f 45;
#X obj 426 187 metro 10;
#X obj 456 237 + 10;
#X text 352 23 midiinfo;
#X text 469 22 bar(rec) start;
#X listbox 104 124 20 0 0 0 - - - 0;
#X msg 317 487 -1;
#X obj 317 460 bng 20 250 50 0 empty \$0-i-clear Clear-Sequence 23 10 0 12 #fcfcfc #000000 #000000;
#X obj 317 512 text delete \$0-sequence-note-trig;
#X obj 310 396 text insert \$0-sequence-note-trig 1e+09;
#X connect 0 0 4 0;
#X connect 0 0 9 1;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 0 28 0;
#X connect 3 0 12 1;
#X connect 4 0 5 0;
#X connect 4 1 6 0;
#X connect 5 0 27 0;
#X connect 6 0 2 1;
#X connect 6 0 8 0;
#X connect 6 0 27 0;
#X connect 7 0 0 0;
#X connect 8 0 7 1;
#X connect 8 0 17 0;
#X connect 9 0 22 0;
#X connect 11 0 31 0;
#X connect 11 0 35 0;
#X connect 12 0 14 0;
#X connect 13 0 2 1;
#X connect 14 0 21 1;
#X connect 16 0 8 0;
#X connect 17 0 15 0;
#X connect 18 0 9 0;
#X connect 19 0 7 0;
#X connect 21 0 11 0;
#X connect 22 0 21 0;
#X connect 22 1 25 0;
#X connect 22 2 13 0;
#X connect 22 2 12 0;
#X connect 23 0 7 0;
#X connect 24 0 9 0;
#X connect 25 0 11 1;
#X connect 25 1 11 2;
#X connect 27 0 1 0;
#X connect 28 0 2 1;
#X connect 32 0 34 0;
#X connect 33 0 32 0;
#X coords 0 -1 1 1 150 50 1 100 100;
#X restore 416 738 pd recording-unit;
#X connect 1 0 31 0;
#X connect 8 0 9 0;
#X connect 9 0 11 0;
#X connect 10 0 8 0;
#X connect 12 0 36 0;
#X connect 13 0 27 0;
#X connect 13 1 28 0;
#X connect 17 0 19 0;
#X connect 19 0 31 1;
#X connect 24 0 25 0;
#X connect 30 0 31 0;
#X connect 36 0 20 0;
#X connect 38 0 45 0;
#X connect 42 0 43 0;
#X connect 43 0 45 1;
#X connect 44 0 45 0;
#X coords 0 977 1 976 300 200 0;
