#N canvas 348 119 955 812 12;
#X obj 558 19 text define -k notes;
#A set ** timer/realtime do not work here since there is no toggle to stop them. Easy to do this with a counter with desired precision (10ms) with metro 10 \; \; \; ** in general since I am not good at finger drumming \, velocity should be considered constant or discarded and hard-coded with possibility of modification using a CC \; \; \; For oneshot sequencer \; - duration of holding the note does not matter \; - velocity should be constant with a CC \; For note sequencer \; - duration is important for ADSR \; - aftertouch could be useful \; \; \; Need to keep textfile closed \, otherwise might experience lag/buginess \;;
#X obj 234 257 inlet;
#X obj 44 268 inlet, f 6;
#X obj 273 422 tgl 20 0 empty empty queue 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 234 445 spigot;
#X listbox 87 552 20 0 0 0 - - - 0;
#X msg 558 69 -1, f 8;
#X obj 60 24 bng 20 250 50 0 \$0-clear-seq \$0-i-clear-seq-dummy Clear 23 10 0 12 #fcfcfc #000000 #000000;
#X obj 87 599 text insert \$0-sequence 1e+09;
#N canvas 778 252 483 637 seq-timer 0;
#X obj 58 270 metro 10;
#X text 120 270 Resolution:10ms;
#X obj 58 296 f;
#X obj 88 296 + 10;
#X floatatom 58 324 12 0 0 1 ms - - 0;
#X obj 58 186 inlet;
#X obj 58 530 outlet;
#X obj 58 508 s \$0-i-abs-time;
#X floatatom 117 121 12 0 0 2 Absolute-Time \$0-i-abs-time \$0-abs-time-dummy 0;
#X obj 58 215 t b b;
#X text 57 166 START-TIMING;
#X obj 290 188 inlet;
#X text 288 169 BAR-DURATION;
#X floatatom 290 212 5 0 0 0 - - - 0;
#X obj 107 187 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 111 374 sel 1;
#X msg 58 242 1;
#X msg 90 242 0;
#X obj 111 414 t b b;
#X obj 111 451 f;
#X msg 143 450 0;
#X text 159 374 WHEN TIME > (BAR DURATION + THRESHOLD): \; 1 - STOP METRO \; 2 - SETS GUI TO BAR DURATION \; 3 - SENDS OUTPUT TO STOP LISTENING TO MIDI \;, f 44;
#X obj 219 527 outlet;
#X obj 111 351 expr if($f1 > $f2+5 \, 1 \, 0);
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 1;
#X connect 4 0 6 0;
#X connect 4 0 7 0;
#X connect 4 0 23 0;
#X connect 5 0 9 0;
#X connect 9 0 16 0;
#X connect 9 1 17 0;
#X connect 11 0 13 0;
#X connect 13 0 19 1;
#X connect 13 0 23 1;
#X connect 14 0 9 0;
#X connect 15 0 18 0;
#X connect 16 0 0 0;
#X connect 17 0 2 1;
#X connect 18 0 19 0;
#X connect 18 1 20 0;
#X connect 19 0 7 0;
#X connect 19 0 4 0;
#X connect 20 0 0 0;
#X connect 20 0 22 0;
#X connect 23 0 15 0;
#X coords 0 -1 1 1 125 50 2 100 100;
#X restore 234 477 pd seq-timer;
#X obj 87 527 f;
#X obj 558 91 text delete \$0-sequence;
#X obj 44 720 outlet;
#X obj 97 576 s \$0-i-recorded;
#X listbox 4 96 8 0 0 1 snap[ms] \$0-i-recorded \$0-recorded-dummy 0;
#X obj 256 537 s \$0-i-absolute-time;
#X floatatom 4 73 8 0 0 1 time[ms] \$0-i-absolute-time \$0-absolute-time-dummy 0;
#X obj 558 47 r \$0-clear-seq;
#X obj 4 24 bng 20 250 50 0 \$0-trig \$0-i-trig-dummy trig 23 10 0 12 #fcfcfc #000000 #000000;
#X obj 455 550 unpack f f;
#X obj 596 276 text define -k \$0-sequence;
#A set;
#X msg 596 252 sort, f 5;
#X obj 455 526 text sequence \$0-sequence;
#X msg 455 502 line 0 \, step;
#X msg 414 686 step;
#X obj 455 700 del;
#X obj 455 576 t b f;
#X floatatom 487 603 5 0 0 0 - - - 0;
#X obj 487 656 -;
#X msg 522 655 0;
#X obj 487 627 t f f;
#X floatatom 487 681 5 0 0 1 NEXT-BANG-IN\ (ms) - - 0;
#X obj 455 477 t b b, f 10;
#N canvas 861 535 450 197 save-text 0;
#X obj 27 36 savestate;
#X obj 87 76 text tolist \$0-sequence;
#X obj 27 118 text fromlist \$0-sequence;
#X connect 0 0 2 0;
#X connect 0 1 1 0;
#X connect 1 0 0 0;
#X restore 788 276 pd save-text;
#X obj 55 309 r \$0-trig;
#X obj 4 49 tgl 20 0 \$0-UI-rec \$0-i-UI-rec RECORD-QUEUE 23 10 0 12 #e0e1e1 #000000 #000000 0 1;
#X obj 751 20 loadbang;
#X msg 751 43 0;
#X obj 273 398 r \$0-UI-rec;
#X obj 751 67 s \$0-i-UI-rec;
#X text 193 3 VERSION 2;
#X text 270 3 REAL-TIME 1-BAR DRUM/ONESHOT SEQUENCER;
#X obj 408 257 inlet;
#X text 407 237 SIGNATUIRE;
#X obj 408 285 unpack f f;
#X floatatom 408 313 5 0 0 1 BAR-DURATION - - 0;
#X text 43 248 MIDI(BANG);
#X text 232 237 LAUNCH(BANG);
#X obj 44 458 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 457 396 WHEN LAUNCH(BANG) ARRIVES \, TEXT SEQUENCE OUTPUTS THE TIME IN WHICH FIRST BANG IS RECORDED \, WAITS(DELAY) THAT AMOUNT OF TIME AND OUTPUTS A BANG \, RECIVING (STEP) AS WELL HOW LONG IT HAS TO WAIT UNTIL NEXT BANG, f 43;
#X obj 87 500 spigot;
#X obj 126 474 tgl 20 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X msg 164 465 1;
#X msg 164 493 0;
#X text 66 348 WHEN LAUNCHED(WITH REC QUEUE ON) \, RECORDER STARTS LISTENING TO MIDI IN. WHEN BAR DURATION IS FINISHED WITHOUT ANY RELAUNCH \, STOPS LISTENING \;, f 23;
#N canvas 115 81 668 559 notes 0;
#X text 41 357 IF SORT RIGHT AFTER EVERY NEW MIDI RECORDED -> "TEXT SEQUENCE \$0-SEQUENCE" WILL LOSE COUNT OF WHAT IT IS OUTPUTTING WITH STEP MESSAGE -> SORT WITH A LAUNCH BANG AND EVEN IF COULD POSSIBLY MAKE MISTAKE FIRST TIME IF NEW MIDI IS VERY CLOSE TO THE BEGINNING OF THE BAR \, NEXT TIME WILL BE FINE \;, f 75;
#X text 41 434 NOTE: IF \$0-SEQUNECE IS EMPTY (NOTHING RECORDED IN IT YET) \, WITH LAUNCH TEXT SEQUNCE WILL OUTPUT AN OUT OF RANGE ERROR. IT IS FINE. IGNORE IT.;
#X text 45 22 DURATION OF THE SEQUNCER IS ONLY 1 BAR;
#X text 45 109 IF RECORD QUEUE IS ON \, WHEN LAUNCH BANG ARRIVES \, TIMER WILL START RUNNING AND SEQUNCER WILL START RECORDING MIDI BANG AT ITS INLET AS WELL AS BANG FROM GUI. WITH EACH ARRIVING BANG THE TIMING OF THE BANG WILL BE INSERTED INTO \$0-SEQUNCE. IF NO NEW LAUNCH ARRIVES \, AFTER (BAR-DURATION+THRESHOLD) RECORDING OF MIDI WILL BE TURNED OFF BUT IT WILL STILL OUTPUT THE BANG FOR LISTENING PURPOSE.;
#X text 45 51 WITH LAUNCH BANG ARRIVED \, TEXT SEQUNECE WILL OUTPUT THE BANGS WITH CORRECT TIMING. THIS PROCESS IS COMPLETELY SEPARATE BUT PARALLEL TO RECORDING (IF ACTIVE).;
#X text 44 323 RECORD-QUEUE WILL ONLY BE TURNED-ON AND OFF MANUALLY.;
#X text 45 228 IF NEXT LAUNCH ARRIVES AT THE END OF BAR-DURATION \, THRESHOLD WILL NEVER REACH AND SO RECORNING WILL STAY ACTIVE.;
#X text 45 280 SYNCHRONIZATION IS MADE SURE WITH (RE)STARTING THE SEQUNCER USING THE LAUNCHER BANG.;
#X restore 196 27 pd notes;
#X text 594 296 TEXT FILE KEEPS ONLY TIMING OF RECORDING BANG, f 26;
#X text 58 291 GUI-BANG;
#X obj 234 280 t b b;
#N canvas 1050 140 450 251 rec-coloring-not-used 0;
#X obj 16 33 sel 0 1;
#X obj 16 58 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 39 58 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 33 135 label record-off;
#X msg 166 134 label recording;
#X obj 16 205 s \$0-i-UI-rec;
#X connect 0 0 1 0;
#X connect 0 1 2 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 4 0 5 0;
#X restore 558 122 pd rec-coloring-not-used;
#X text 2 1 DRUM-SEQ (1-BAR);
#X text 596 171 WHEN ADD A NEW MIDI TO A RUNNING RECORDED SEQUENCE IT WILL MESS UP THE ONGOING RECORDING SEQUNECE BUT FROM NEXT LOOP IT WILL BE FINE. LATER ON COULD INVESTIGATE AND THINK OF A BETTER WAY., f 41;
#X connect 1 0 58 0;
#X connect 2 0 48 0;
#X connect 3 0 4 1;
#X connect 4 0 9 0;
#X connect 4 0 52 0;
#X connect 5 0 8 0;
#X connect 5 0 13 0;
#X connect 6 0 11 0;
#X connect 9 0 10 1;
#X connect 9 0 15 0;
#X connect 9 1 53 0;
#X connect 10 0 5 0;
#X connect 17 0 6 0;
#X connect 19 0 26 0;
#X connect 21 0 20 0;
#X connect 22 0 19 0;
#X connect 23 0 22 0;
#X connect 24 0 22 0;
#X connect 25 0 24 0;
#X connect 25 0 12 0;
#X connect 26 0 25 0;
#X connect 26 1 27 0;
#X connect 27 0 30 0;
#X connect 28 0 31 0;
#X connect 29 0 28 1;
#X connect 30 0 28 1;
#X connect 30 1 28 0;
#X connect 31 0 25 1;
#X connect 32 0 23 0;
#X connect 32 1 29 0;
#X connect 34 0 48 0;
#X connect 36 0 37 0;
#X connect 37 0 39 0;
#X connect 38 0 3 0;
#X connect 42 0 44 0;
#X connect 44 1 45 0;
#X connect 45 0 9 1;
#X connect 48 0 12 0;
#X connect 48 0 50 0;
#X connect 50 0 10 0;
#X connect 51 0 50 1;
#X connect 52 0 51 0;
#X connect 53 0 51 0;
#X connect 58 0 4 0;
#X connect 58 0 32 0;
#X connect 58 1 21 0;
#X coords 0 -1 1 1 125 120 2 0 0;
