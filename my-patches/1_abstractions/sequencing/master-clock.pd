#N canvas 734 373 916 397 12;
#X floatatom 154 141 5 0 0 1 BPM i-bpm bpm 0;
#X obj 190 261 expr 60000/$f1;
#X obj 190 286 * 4;
#X floatatom 190 314 6 0 0 1 beat\ durations\ (milisecond) - - 0;
#X obj 107 120 tgl 40 0 empty i-clock-on empty 0 -10 0 12 #ff0400 #000000 #000000 0 1;
#X text 12 10 Master-Clock;
#X obj 190 337 s beat-duration;
#X obj 190 235 r bpm;
#X text 382 14 VERSION 1;
#N canvas 220 124 1042 563 parameter-init-handling 0;
#X obj 54 42 loadbang;
#X obj 54 73 f \$0;
#X obj 27 42 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 54 101 \; \$1-param-write 0 \; i-bpm 60 \; \$1-param-write 1 \;;
#X obj 250 97 t b f, f 2;
#X obj 250 210 text set \$0-parameters 0 0;
#X obj 251 248 savestate;
#X obj 311 301 text sequence \$0-parameters;
#X msg 311 276 line 0 \, step;
#X obj 250 159 pack f, f 7;
#X obj 250 41 text define -k \$0-parameters;
#A set 78 \;;
#X obj 250 70 r bpm;
#X obj 251 335 unpack f;
#X obj 251 386 s i-bpm;
#X obj 303 183 tgl 20 0 empty \$0-param-write empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 250 183 spigot;
#X obj 251 360 pipe 200;
#X text 535 41 1 - When patch is initialized \, initialization value is set with the loadbang \; 2 - \$0-param-write is a toggle that stops loadbang from setting initialization value into \$0-parameter each time it is loaded \, and right after is turned on to allow manual modification to be written into \$0-parameters \; 3- when patch is saved \$0-parameter will be written into savestate \; 4- when abstraction is loaded again \, the savestate value will be written into its destination. pipe object is considered here to make sure there is no conflict with load bang init value \;, f 71;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 4 0 9 0;
#X connect 4 1 9 0;
#X connect 6 0 12 0;
#X connect 6 1 8 0;
#X connect 7 0 6 0;
#X connect 8 0 7 0;
#X connect 9 0 15 0;
#X connect 11 0 4 0;
#X connect 12 0 16 0;
#X connect 14 0 15 1;
#X connect 15 0 5 0;
#X connect 16 0 13 0;
#X restore 103 62 pd parameter-init-handling;
#X text 381 52 Each time clock is toggeled on \; ------------------------------ \; 1 - BPM value should be resent again \; 2 - Wait a little for other abstractions to recalculate their values \; 3 - Send clock-on, f 70;
#X obj 107 337 s clock-on;
#X obj 107 311 pipe 1000;
#X obj 107 169 sel 1 0;
#X msg 107 250 1;
#X msg 142 250 bang;
#X msg 130 275 0, f 2;
#X obj 627 192 s i-clock-on;
#X obj 627 164 r mpd-pad-8-master-clock;
#X text 624 141 Receive clock-on from mpd;
#X obj 329 275 s i-mpd-pad-8-master-clock;
#X msg 329 250 set 1;
#X text 329 148 Turn mpd218 UI on/off in case manually turning on/off from the abstraction, f 33;
#X msg 329 228 set 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 6 0;
#X connect 4 0 13 0;
#X connect 7 0 1 0;
#X connect 12 0 11 0;
#X connect 13 0 14 0;
#X connect 13 0 15 0;
#X connect 13 0 21 0;
#X connect 13 1 16 0;
#X connect 13 1 23 0;
#X connect 14 0 12 0;
#X connect 15 0 3 0;
#X connect 16 0 12 0;
#X connect 18 0 17 0;
#X connect 21 0 20 0;
#X connect 23 0 20 0;
#X coords 0 -1 1 1 130 65 1 100 100;
