#N canvas 710 93 826 744 12;
#X text 314 10 VERSION 0;
#X obj 504 39 text define -k notes;
#A set ** timer/realtime do not work here since there is no toggle to stop them. Easy to do this with a counter with desired precision (10ms) with metro 10 \; \; \; ** in general since I am not good at finger drumming \, velocity should be considered constant or discarded and hard-coded with possibility of modification using a CC \; \; \; For oneshot sequencer \; - duration of holding the note does not matter \; - velocity should be constant with a CC \; For note sequencer \; - duration is important for ADSR \; - aftertouch could be useful \; \; \; Need to keep textfile closed \, otherwise might experience lag/buginess \;;
#X text 405 11 Realtime sequencer: for One-shot input;
#X obj 111 174 inlet;
#X obj 185 175 inlet;
#X obj 251 174 inlet, f 7;
#X obj 19 173 inlet;
#X text 109 155 Record;
#X text 179 151 Launch;
#X text 249 154 End/Loop;
#X text 18 153 Midi;
#X obj 111 334 tgl 20 0 empty empty GO 23 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 72 359 spigot;
#X listbox 72 463 20 0 0 0 - - - 0;
#X msg 319 81 -1;
#X obj 254 52 bng 20 250 50 0 \$0-clear-seq \$0-i-clear-seq-dummy Clear -40 10 0 12 #fcfcfc #000000 #000000;
#X obj 72 509 text insert \$0-sequence 1e+09;
#X obj 19 281 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 217 287 sel 0 1, f 9;
#N canvas 778 252 848 411 seq-timer 0;
#X msg 343 148 1;
#X msg 404 184 0;
#X obj 343 225 metro 10;
#X text 407 226 Resolution:10ms;
#X text 557 20 - record start the metro \; - end stops the metro and reset to 0 the output \; - loop stops reset to 0 the output \; - each midi input resets the output to 0 \;;
#X obj 450 277 f;
#X obj 480 277 + 10;
#X floatatom 450 325 13 0 0 1 ms - - 0;
#X msg 468 141 0;
#X obj 343 100 inlet;
#X obj 404 99 inlet;
#X obj 468 99 inlet;
#X obj 450 357 outlet;
#X text 340 66 start record, f 6;
#X text 402 66 end record, f 6;
#X text 467 65 loop record, f 6;
#X text 456 307 absolute time from the first bar;
#X obj 506 356 s \$0-i-abs-time;
#X floatatom 117 121 12 0 0 2 Absolute-Time \$0-i-abs-time \$0-abs-time-dummy 0;
#X connect 0 0 2 0;
#X connect 1 0 2 0;
#X connect 1 0 5 1;
#X connect 2 0 5 0;
#X connect 5 0 6 0;
#X connect 5 0 7 0;
#X connect 6 0 5 1;
#X connect 7 0 12 0;
#X connect 7 0 17 0;
#X connect 8 0 5 1;
#X connect 9 0 0 0;
#X connect 10 0 1 0;
#X connect 11 0 8 0;
#X coords 0 -1 1 1 125 50 2 100 100;
#X restore 158 388 pd seq-timer;
#X obj 72 388 bng 20 250 50 0 empty empty midi -2 27 0 10 #fcfcfc #000000 #000000;
#X obj 158 335 bng 20 250 50 0 empty empty start 23 10 0 10 #fcfcfc #000000 #000000;
#X obj 217 336 bng 20 250 50 0 empty empty end 23 10 0 10 #fcfcfc #000000 #000000;
#X obj 276 336 bng 20 250 50 0 empty empty loop 23 10 0 10 #fcfcfc #000000 #000000;
#X obj 72 438 f;
#X msg 111 281 1;
#X msg 118 307 0;
#X obj 319 106 text delete \$0-sequence;
#X text 445 173 when recording: if loop happens \, previous midi input should be replayed --> Launch them., f 21;
#X obj 19 546 outlet;
#X text 16 590 Sorting with every midi in will result in step of \$0-sequence to lose the count. for example if an index is added before it \, next step will output again the previous step since index is moved one up. --> Sort at the beginning of the launch. But will it be fast enough? - lets hope so;
#X obj 289 383 s \$0-bang-loop;
#X obj 223 360 s \$0-bang-end;
#X obj 82 487 s \$0-i-recorded;
#X listbox 65 73 11 0 0 1 snap \$0-i-recorded \$0-recorded-dummy 0;
#X obj 158 441 s \$0-i-absolute-time;
#X floatatom 65 52 8 0 0 1 time[ms] \$0-i-absolute-time \$0-absolute-time-dummy 0;
#X obj 319 55 r \$0-clear-seq;
#X obj 10 52 bng 39 250 50 0 \$0-trig \$0-i-trig-dummy BANG 5 20 0 12 #fcfcfc #000000 #000000;
#X text 1 0 Midi;
#X text 80 0 Record;
#X text 236 0 End/Loop;
#X text 166 0 Launch;
#X text 8 28 DRUM SEQUENCER;
#X obj 438 364 unpack f f;
#X obj 615 307 text define -k \$0-sequence;
#A set;
#X msg 557 306 sort, f 5;
#X obj 438 339 text sequence \$0-sequence;
#X msg 438 311 line 0 \, step;
#X msg 397 515 step;
#X obj 438 526 del;
#X obj 438 389 t b f;
#X floatatom 470 416 5 0 0 0 - - - 0;
#X obj 470 469 -;
#X msg 504 468 0;
#X obj 470 440 t f f;
#X floatatom 470 494 5 0 0 1 \ next-bang-in\ (ms) - - 0;
#X text 541 363 This structure is for outputting the sequence considering the first item in each row is absolute time from start of the first bar., f 34;
#X obj 438 286 t b b, f 10;
#X obj 449 258 r \$0-bang-loop;
#X obj 557 270 r \$0-bang-end;
#X obj 641 341 print;
#N canvas 861 535 450 197 save-text 0;
#X obj 27 36 savestate;
#X obj 87 76 text tolist \$0-sequence;
#X obj 124 37 bng 20 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 27 118 text fromlist \$0-sequence;
#X connect 0 0 3 0;
#X connect 0 1 1 0;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X restore 713 281 pd save-text;
#X obj 30 254 r \$0-trig;
#X connect 3 0 21 0;
#X connect 3 0 25 0;
#X connect 4 0 58 0;
#X connect 5 0 18 0;
#X connect 6 0 17 0;
#X connect 11 0 12 1;
#X connect 12 0 20 0;
#X connect 13 0 16 0;
#X connect 13 0 33 0;
#X connect 14 0 27 0;
#X connect 17 0 12 0;
#X connect 17 0 29 0;
#X connect 18 0 22 0;
#X connect 18 0 26 0;
#X connect 18 1 23 0;
#X connect 19 0 24 1;
#X connect 19 0 35 0;
#X connect 20 0 24 0;
#X connect 21 0 19 0;
#X connect 22 0 19 1;
#X connect 22 0 32 0;
#X connect 23 0 19 2;
#X connect 23 0 31 0;
#X connect 24 0 13 0;
#X connect 25 0 11 0;
#X connect 26 0 11 0;
#X connect 37 0 14 0;
#X connect 44 0 51 0;
#X connect 45 0 61 0;
#X connect 46 0 45 0;
#X connect 47 0 44 0;
#X connect 48 0 47 0;
#X connect 49 0 47 0;
#X connect 50 0 49 0;
#X connect 50 0 29 0;
#X connect 51 0 50 0;
#X connect 51 1 52 0;
#X connect 52 0 55 0;
#X connect 53 0 56 0;
#X connect 54 0 53 1;
#X connect 55 0 53 1;
#X connect 55 1 53 0;
#X connect 56 0 50 1;
#X connect 58 0 48 0;
#X connect 58 1 54 0;
#X connect 58 1 46 0;
#X connect 59 0 58 0;
#X connect 60 0 46 0;
#X connect 63 0 17 0;
#X coords 0 -1 1 1 297 100 2 0 0;
